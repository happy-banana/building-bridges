{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/isomorphic-fetch/fetch-npm-browserify.js","node_modules/process/browser.js","node_modules/whatwg-fetch/fetch.js","src/presentation/js/classes/MobileServerBridge.js","src/presentation/js/classes/src/presentation/js/classes/NodeAppRunner.js","src/presentation/js/classes/Presentation.js","src/presentation/js/classes/SlideBridge.js","src/presentation/js/classes/live-code/CodeElement.js","src/presentation/js/classes/live-code/ConsoleElement.js","src/presentation/js/classes/live-code/TerminalElement.js","src/presentation/js/classes/live-code/WebPreviewElement.js","src/presentation/js/classes/live-code/index.js","src/presentation/js/script.js","src/server/classes/SlidesFolderParser.js","src/shared/js/Constants.js","src/shared/js/classes/ContentBase.js","src/shared/js/classes/MobileServerBridge.js","src/shared/js/classes/Presentation.js","src/shared/js/classes/SlideBridge.js","src/presentation/js/classes/live-code-slide/index.js","src/presentation/js/classes/megapudding-slide/index.js","src/presentation/js/classes/shake-your-phones-slide/index.js","src/presentation/js/classes/video-slide/index.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA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","file":"script.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","// the whatwg-fetch polyfill installs the fetch() function\n// on the global object (window or self)\n//\n// Return that as the export for use in Webpack, Browserify etc.\nrequire('whatwg-fetch');\nmodule.exports = self.fetch.bind(self);\n","// shim for using process in browser\n\nvar process = module.exports = {};\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = setTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    clearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        setTimeout(drainQueue, 0);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","(function(self) {\n  'use strict';\n\n  if (self.fetch) {\n    return\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name)\n    }\n    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value)\n    }\n    return value\n  }\n\n  function Headers(headers) {\n    this.map = {}\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value)\n      }, this)\n\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name])\n      }, this)\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name)\n    value = normalizeValue(value)\n    var list = this.map[name]\n    if (!list) {\n      list = []\n      this.map[name] = list\n    }\n    list.push(value)\n  }\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)]\n  }\n\n  Headers.prototype.get = function(name) {\n    var values = this.map[normalizeName(name)]\n    return values ? values[0] : null\n  }\n\n  Headers.prototype.getAll = function(name) {\n    return this.map[normalizeName(name)] || []\n  }\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  }\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = [normalizeValue(value)]\n  }\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    Object.getOwnPropertyNames(this.map).forEach(function(name) {\n      this.map[name].forEach(function(value) {\n        callback.call(thisArg, value, name, this)\n      }, this)\n    }, this)\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result)\n      }\n      reader.onerror = function() {\n        reject(reader.error)\n      }\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader()\n    reader.readAsArrayBuffer(blob)\n    return fileReaderReady(reader)\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader()\n    reader.readAsText(blob)\n    return fileReaderReady(reader)\n  }\n\n  var support = {\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\n      try {\n        new Blob();\n        return true\n      } catch(e) {\n        return false\n      }\n    })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  }\n\n  function Body() {\n    this.bodyUsed = false\n\n\n    this._initBody = function(body) {\n      this._bodyInit = body\n      if (typeof body === 'string') {\n        this._bodyText = body\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body\n      } else if (!body) {\n        this._bodyText = ''\n      } else if (support.arrayBuffer && ArrayBuffer.prototype.isPrototypeOf(body)) {\n        // Only support ArrayBuffers for POST method.\n        // Receiving ArrayBuffers happens via Blobs, instead.\n      } else {\n        throw new Error('unsupported BodyInit type')\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type)\n        }\n      }\n    }\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      }\n\n      this.arrayBuffer = function() {\n        return this.blob().then(readBlobAsArrayBuffer)\n      }\n\n      this.text = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return readBlobAsText(this._bodyBlob)\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as text')\n        } else {\n          return Promise.resolve(this._bodyText)\n        }\n      }\n    } else {\n      this.text = function() {\n        var rejected = consumed(this)\n        return rejected ? rejected : Promise.resolve(this._bodyText)\n      }\n    }\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      }\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    }\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase()\n    return (methods.indexOf(upcased) > -1) ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {}\n    var body = options.body\n    if (Request.prototype.isPrototypeOf(input)) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url\n      this.credentials = input.credentials\n      if (!options.headers) {\n        this.headers = new Headers(input.headers)\n      }\n      this.method = input.method\n      this.mode = input.mode\n      if (!body) {\n        body = input._bodyInit\n        input.bodyUsed = true\n      }\n    } else {\n      this.url = input\n    }\n\n    this.credentials = options.credentials || this.credentials || 'omit'\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers)\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET')\n    this.mode = options.mode || this.mode || null\n    this.referrer = null\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body)\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this)\n  }\n\n  function decode(body) {\n    var form = new FormData()\n    body.trim().split('&').forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n    return form\n  }\n\n  function headers(xhr) {\n    var head = new Headers()\n    var pairs = xhr.getAllResponseHeaders().trim().split('\\n')\n    pairs.forEach(function(header) {\n      var split = header.trim().split(':')\n      var key = split.shift().trim()\n      var value = split.join(':').trim()\n      head.append(key, value)\n    })\n    return head\n  }\n\n  Body.call(Request.prototype)\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {}\n    }\n\n    this.type = 'default'\n    this.status = options.status\n    this.ok = this.status >= 200 && this.status < 300\n    this.statusText = options.statusText\n    this.headers = options.headers instanceof Headers ? options.headers : new Headers(options.headers)\n    this.url = options.url || ''\n    this._initBody(bodyInit)\n  }\n\n  Body.call(Response.prototype)\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  }\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''})\n    response.type = 'error'\n    return response\n  }\n\n  var redirectStatuses = [301, 302, 303, 307, 308]\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  }\n\n  self.Headers = Headers;\n  self.Request = Request;\n  self.Response = Response;\n\n  self.fetch = function(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request\n      if (Request.prototype.isPrototypeOf(input) && !init) {\n        request = input\n      } else {\n        request = new Request(input, init)\n      }\n\n      var xhr = new XMLHttpRequest()\n\n      function responseURL() {\n        if ('responseURL' in xhr) {\n          return xhr.responseURL\n        }\n\n        // Avoid security warnings on getResponseHeader when not allowed by CORS\n        if (/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())) {\n          return xhr.getResponseHeader('X-Request-URL')\n        }\n\n        return;\n      }\n\n      xhr.onload = function() {\n        var status = (xhr.status === 1223) ? 204 : xhr.status\n        if (status < 100 || status > 599) {\n          reject(new TypeError('Network request failed'))\n          return\n        }\n        var options = {\n          status: status,\n          statusText: xhr.statusText,\n          headers: headers(xhr),\n          url: responseURL()\n        }\n        var body = 'response' in xhr ? xhr.response : xhr.responseText;\n        resolve(new Response(body, options))\n      }\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.open(request.method, request.url, true)\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob'\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n    })\n  }\n  self.fetch.polyfill = true\n})(typeof self !== 'undefined' ? self : this);\n","import MobileServerBridgeBase from '../../../shared/js/classes/MobileServerBridge';\r\nimport {Constants} from '../../../shared/js/Constants';\r\n\r\nexport default class MobileServerBridge extends MobileServerBridgeBase{\r\n\r\n  constructor(presentation, settings) {\r\n    super(presentation, settings);\r\n    bean.on(this.presentation, Constants.SET_CURRENT_SLIDE_INDEX, this.currentSlideIndexChanged.bind(this));\r\n  }\r\n\r\n  socketConnectHandler() {\r\n    super.socketConnectHandler();\r\n    this.tryToSend(Constants.MESSAGE, {\r\n      target: {\r\n        client: 'mobile',\r\n      },\r\n      content: {\r\n        action: Constants.SET_CURRENT_SLIDE_INDEX,\r\n        currentSlideIndex: this.presentation.currentSlideIndex\r\n      }\r\n    });\r\n  }\r\n\r\n  currentSlideIndexChanged(currentSlideIndex) {\r\n    this.tryToSend(Constants.MESSAGE, {\r\n      target: {\r\n        client: 'mobile',\r\n      },\r\n      content: {\r\n        action: Constants.SET_CURRENT_SLIDE_INDEX,\r\n        currentSlideIndex: currentSlideIndex\r\n      }\r\n    });\r\n  }\r\n\r\n}\r\n","let childProcess = requireNode('child_process');\r\nlet EventEmitter = requireNode('events').EventEmitter;\r\nlet path = requireNode('path');\r\n\r\nlet platform = requireNode('remote').process.platform;\r\nlet isWin = /^win/.test(platform);\r\n\r\n//kill entire process tree\r\n//http://krasimirtsonev.com/blog/article/Nodejs-managing-child-processes-starting-stopping-exec-spawn\r\nconst kill = (pid, signal) => {\r\n  signal = signal || 'SIGKILL';\r\n  return new Promise((resolve, reject) => {\r\n    if(!isWin) {\r\n      let psTree = requireNode('ps-tree');\r\n      let killTree = true;\r\n      if(killTree) {\r\n        psTree(pid, (err, children) => {\r\n          [pid].concat(children.map(p => p.PID)).forEach(tpid => {\r\n            try { process.kill(tpid, signal); }\r\n            catch (ex) { }\r\n          });\r\n        });\r\n      } else {\r\n        try { process.kill(pid, signal); }\r\n        catch (ex) { }\r\n      }\r\n      resolve();\r\n    } else {\r\n      childProcess.exec('taskkill /PID ' + pid + ' /T /F', (error, stdout, stderr) => {\r\n        resolve();\r\n      });\r\n    }\r\n  });\r\n};\r\n\r\nexport default class NodeAppRunner extends EventEmitter {\r\n  constructor() {\r\n    super();\r\n  }\r\n  run(applicationPath) {\r\n    return this.stop()\r\n    .then(() => {\r\n      this.cwd = path.dirname(applicationPath);\r\n      this.numDataEventsReceived = 0;\r\n      this.ignoreFirstEventsAmount = 0;\r\n      if(isWin) {\r\n        this.ignoreFirstEventsAmount = 2;\r\n        this.runner = childProcess.spawn(\"cmd\", [\"nvmw\", \"use\", \"iojs-v2.3.1\"], {cwd: this.cwd});\r\n        setTimeout(() => {\r\n          this.runner.stdin.write(\"node \" + applicationPath + \"\\n\");\r\n        }, 500);\r\n      } else {\r\n        console.log('node ' + applicationPath);\r\n        this.runner = childProcess.spawn(\"node\", [applicationPath], {cwd: this.cwd});\r\n      }\r\n      this.runner.stdout.on('data', data => this.onRunnerData(data));\r\n      this.runner.stderr.on('data', error => this.onRunnerError(error));\r\n      this.runner.on('disconnect', () => this.onDisconnect());\r\n      this.runner.on('close', () => this.onClose());\r\n      this.runner.on('exit', () => this.onExit());\r\n    });\r\n  }\r\n  onRunnerData(data) {\r\n    this.numDataEventsReceived++;\r\n    if(this.numDataEventsReceived <= this.ignoreFirstEventsAmount) {\r\n      //ignore the first x-messages\r\n      return;\r\n    }\r\n    data = data.toString().trim();\r\n    if(data.indexOf(this.cwd) === 0) {\r\n      data = data.substr(this.cwd.length);\r\n      if(data.length === 1) {\r\n        return;\r\n      }\r\n    }\r\n    this.emit('stdout-data', data);\r\n  }\r\n\r\n  onRunnerError(error) {\r\n    this.emit('stderr-data', error.toString().trim());\r\n  }\r\n\r\n  onDisconnect() {\r\n    console.log('[ChildApp] runner disconnected');\r\n    this.runner = false;\r\n  }\r\n\r\n  onClose() {\r\n    console.log('[ChildApp] runner closed');\r\n    this.runner = false;\r\n  }\r\n\r\n  onExit() {\r\n    console.log('[ChildApp] runner exited');\r\n    this.runner = false;\r\n  }\r\n\r\n  stop() {\r\n    return new Promise((resolve, reject) => {\r\n      if(!this.runner) {\r\n        resolve();\r\n      }\r\n      this.runner.stdout.removeAllListeners();\r\n      this.runner.stderr.removeAllListeners();\r\n      this.runner.stdin.end();\r\n      //listen for runner events and resolve on the one that occurs\r\n      let cbCalled = false;\r\n      // this.runner.on('disconnect', () => {\r\n      //   console.log('disconnect');\r\n      //   if(!cbCalled) {\r\n      //     resolve();\r\n      //   }\r\n      // });\r\n      // this.runner.on('close', () => {\r\n      //   console.log('close');\r\n      //   if(!cbCalled) {\r\n      //     resolve();\r\n      //   }\r\n      // });\r\n      // this.runner.on('exit', () => {\r\n      //   console.log('exit');\r\n      //   if(!cbCalled) {\r\n      //     resolve();\r\n      //   }\r\n      // });\r\n      kill(this.runner.pid).then(() => {\r\n        resolve();\r\n      });\r\n      this.runner = false;\r\n    });\r\n  }\r\n  destroy() {\r\n    return this.stop()\r\n    .then(() => {\r\n    });\r\n  }\r\n}\r\n","import {Constants} from '../../../shared/js/Constants';\r\nimport PresentationBase from '../../../shared/js/classes/Presentation';\r\nimport SlideBridge from './SlideBridge';\r\nimport MobileServerBridge from './MobileServerBridge';\r\n\r\nconst path = requireNode('path');\r\n\r\nconst KEYCODE_LEFT = 37;\r\nconst KEYCODE_RIGHT = 39;\r\n\r\nexport default class Presentation extends PresentationBase {\r\n  constructor(data, role, settings) {\r\n    super(data, role, settings);\r\n\r\n    window.onbeforeunload = event => this.closeHandler(event);\r\n    $(window).on('keydown', event => this.keydownHandler(event));\r\n    bean.on(this, Constants.SET_CURRENT_SLIDE_INDEX, this.currentSlideIndexChangedHandler.bind(this));\r\n\r\n    //forward childapp messages\r\n    // ChildApp.getInstance().on('stdout-data', this.childAppDataHandler.bind(this));\r\n    // ChildApp.getInstance().on('stderr-data', this.childAppErrorHandler.bind(this));\r\n\r\n    $('body').on(Constants.GO_TO_PREVIOUS_SLIDE, this.goToPreviousSlide.bind(this));\r\n    $('body').on(Constants.GO_TO_NEXT_SLIDE, this.goToNextSlide.bind(this));\r\n    $('body').on(Constants.OPEN_COMMAND_LINE, this.openCommandLine.bind(this));\r\n    $('body').on(Constants.OPEN_CAMERA, this.openCamera.bind(this));\r\n  }\r\n\r\n  closeHandler(event) {\r\n    // if(ChildApp.getInstance().isRunning()) {\r\n    //   ChildApp.getInstance().stop(function(){\r\n    //     console.log('Presentation: childapp stopped');\r\n    //     requireNode('remote').getCurrentWindow().close();\r\n    //   });\r\n    //   return false;\r\n    // }\r\n  }\r\n\r\n  currentSlideIndexChangedHandler(slideIndex) {\r\n    console.log('Presentation: currentSlideIndexChangedHandler');\r\n    // if(ChildApp.getInstance().isRunning()) {\r\n    //   ChildApp.getInstance().stop(function(){\r\n    //     console.log('Presentation: childapp stopped');\r\n    //   });\r\n    // }\r\n  }\r\n\r\n  createMobileServerBridge() {\r\n    return new MobileServerBridge(this, this.settings);\r\n  }\r\n\r\n  toggleElevatorMusic() {\r\n    this.elevatorMusicPlaying = !this.elevatorMusicPlaying;\r\n    if(this.elevatorMusicPlaying) {\r\n      this.elevatorMusic.play();\r\n    } else {\r\n      this.elevatorMusic.pause();\r\n    }\r\n  }\r\n\r\n  //prepend urls with file:/// (faster?)\r\n  processSlideSrc(src) {\r\n    src = 'file:///' + path.resolve(this.settings.presentationPath, src);\r\n    src = src.replace(/\\\\/g,\"/\");\r\n    return src;\r\n  }\r\n\r\n  createSlideBridges(data) {\r\n    PresentationBase.prototype.createSlideBridges.call(this, data);\r\n    var that = this;\r\n    var $slideMenu = $('#slideMenu');\r\n    var numSlideBridges = this.slideBridges.length;\r\n    for(var i = 0; i < numSlideBridges; i++) {\r\n      var slideBridge = this.slideBridges[i];\r\n      $slideMenu.append('<button type=\"button\" data-slidenr=\"' + i + '\" class=\"dropdown-item\">' + (i + 1) + ' ' + slideBridge.name + '</button>');\r\n    }\r\n    $slideMenu.find('button').on('click', function(event){\r\n      event.preventDefault();\r\n      that.setCurrentSlideIndex(parseInt($(this).data('slidenr')));\r\n    });\r\n  }\r\n\r\n  createSlideBridge(slide) {\r\n    //use our own bridge which doesn't use fetch\r\n    return new SlideBridge(slide);\r\n  }\r\n\r\n  slideMessageHandler(event) {\r\n    PresentationBase.prototype.slideMessageHandler.call(this, event);\r\n    if(!event.data) {\r\n      return;\r\n    }\r\n    switch(event.data.action) {\r\n      case Constants.GO_TO_PREVIOUS_SLIDE:\r\n        this.goToPreviousSlide();\r\n        break;\r\n      case Constants.GO_TO_NEXT_SLIDE:\r\n        this.goToNextSlide();\r\n        break;\r\n      case Constants.OPEN_COMMAND_LINE:\r\n        this.openCommandLine();\r\n        break;\r\n      case Constants.OPEN_CAMERA:\r\n        this.openCamera();\r\n        break;\r\n      case Constants.CHILD_APP_SAVE_CODE:\r\n        ChildApp.getInstance().saveCode(event.data.code, event.data.type);\r\n        break;\r\n      case Constants.CHILD_APP_RUN_CODE:\r\n        ChildApp.getInstance().runCode(event.data.code, event.data.type);\r\n        break;\r\n    }\r\n  }\r\n\r\n  keydownHandler(event) {\r\n    //one frame delay\r\n    window.requestAnimationFrame(() => {\r\n      if(event.isImmediatePropagationStopped()) {\r\n        return;\r\n      }\r\n      switch(event.keyCode) {\r\n        case KEYCODE_LEFT:\r\n          this.goToPreviousSlide();\r\n          break;\r\n        case KEYCODE_RIGHT:\r\n          this.goToNextSlide();\r\n          break;\r\n      }\r\n    });\r\n  }\r\n\r\n  childAppDataHandler(data) {\r\n    var currentSlideBridge = this.getSlideBridgeByIndex(this.currentSlideIndex);\r\n    if(currentSlideBridge) {\r\n      currentSlideBridge.tryToPostMessage({\r\n        action: Constants.CHILD_APP_STDOUT_DATA,\r\n        data: data\r\n      });\r\n    }\r\n  }\r\n\r\n  childAppErrorHandler(data) {\r\n    var currentSlideBridge = this.getSlideBridgeByIndex(this.currentSlideIndex);\r\n    if(currentSlideBridge) {\r\n      currentSlideBridge.tryToPostMessage({\r\n        action: Constants.CHILD_APP_STDERR_DATA,\r\n        data: data\r\n      });\r\n    }\r\n  }\r\n\r\n  openCommandLine() {\r\n    $('#consoleModal').modal('show');\r\n  }\r\n\r\n  openCamera() {\r\n    $('#webcamModal').modal('show');\r\n  }\r\n\r\n  handleMobileServerMessage(message) {\r\n    if(message.content) {\r\n      if(message.content.action === 'goToNextSlide') {\r\n        this.goToNextSlide();\r\n      } else if(message.content.action === 'goToPreviousSlide') {\r\n        this.goToPreviousSlide();\r\n      }\r\n    }\r\n  }\r\n}\r\n","import SlideBridgeBase from '../../../shared/js/classes/SlideBridge';\r\n\r\nexport default class SlideBridge extends SlideBridgeBase {\r\n\r\n  attachToSlideHolder(slideHolder, src, cb) {\r\n    this.slideHolder = slideHolder;\r\n    //notify the content it is being cleared\r\n    this.tryToPostMessage({action: 'destroy'});\r\n    //clear the current content\r\n    this.slideHolder.innerHTML = '';\r\n    $(slideHolder).attr('data-name', this.name);\r\n    $(slideHolder).addClass('loading');\r\n\r\n    $(slideHolder).on('load', () => {\r\n      this.tryToPostMessage({\r\n        action: 'setState',\r\n        state: this.state\r\n      });\r\n      $(slideHolder).off('load');\r\n    });\r\n\r\n    if(src !== $(slideHolder).attr('data-src')) {\r\n      //create html import\r\n      var $importEl = $('<link rel=\"import\">');\r\n      var importEl = $importEl[0];\r\n      $importEl.on('load', (function(){\r\n        var template = importEl.import.querySelector('template');\r\n        if(template) {\r\n          var clone = document.importNode(template.content, true);\r\n          this.slideHolder.appendChild(clone);\r\n        }\r\n        $importEl.remove();\r\n        $(slideHolder).removeClass('loading');\r\n        cb();\r\n      }).bind(this));\r\n      $(slideHolder).html($importEl);\r\n      $importEl.attr('href', src);\r\n      $(slideHolder).attr('data-src', src);\r\n    }\r\n  };\r\n}\r\n","const fs = requireNode('fs-promise');\r\n\r\nexport default class CodeElement {\r\n  constructor(el, options) {\r\n    this.el = el;\r\n    this.$el = $(el);\r\n    //options\r\n    if(!options)\r\n    {\r\n      options = {};\r\n    }\r\n\r\n    let width = $(el).parent()[0].style.width || '100%';\r\n    let height = $(el).parent()[0].style.height || '100%';\r\n\r\n    //wrap element in a container\r\n    this.$wrapperEl = $(el).wrap('<div class=\"live-code-element live-code-code-element\"></div>').parent();\r\n    this.wrapperEl = this.$wrapperEl[0];\r\n\r\n    this.id = this.$el.attr('data-id');\r\n    this.file = this.$el.data('file');\r\n\r\n    if(!this.id && this.file)\r\n    {\r\n      this.id = this.file;\r\n    }\r\n    if(!this.id)\r\n    {\r\n      this.id = 'code-' + Math.round(Math.random() * 1000 * new Date().getTime());\r\n    }\r\n    this.$el.attr('data-id', this.id);\r\n\r\n    this.runtime = this.$el.data('runtime');\r\n    if(!this.runtime)\r\n    {\r\n      this.runtime = 'browser';\r\n    }\r\n\r\n    this.console = this.$el.data('console');\r\n    this.processor = this.$el.data('processor');\r\n\r\n    //language is programming language - used for injecting in html\r\n    this.language = this.$el.data('language');\r\n    if(!this.language)\r\n    {\r\n      //default to javascript\r\n      this.language = \"javascript\";\r\n    }\r\n\r\n    //mode is mode for codemirror\r\n    this.mode = this.$el.data('mode');\r\n    if(!this.mode)\r\n    {\r\n      //default to the language\r\n      this.mode = this.language;\r\n    }\r\n\r\n    this.codeMirror = CodeMirror.fromTextArea(this.el, {\r\n      lineNumbers: true,\r\n      mode: this.mode,\r\n      extraKeys: {\"Ctrl-Space\": \"autocomplete\"}\r\n    });\r\n\r\n    this.codeMirror.setSize(width, height);\r\n\r\n    //this.$el.css('width', '100%').css('height', '100%');\r\n    this.layout();\r\n  }\r\n\r\n  stop() {\r\n  }\r\n\r\n  destroy() {\r\n    stop();\r\n  }\r\n\r\n  getValue() {\r\n    return this.codeMirror.getValue();\r\n  }\r\n\r\n  setValue(value) {\r\n    this.codeMirror.setValue(value);\r\n  }\r\n\r\n  saveToFile(filePath) {\r\n    return fs.writeFile(filePath, this.getValue());\r\n  }\r\n\r\n  readFromFile(filePath) {\r\n    return fs.readFile(filePath, 'utf8')\r\n      .then(data => {\r\n        this.setValue(data);\r\n        return data;\r\n      });\r\n  }\r\n\r\n  layout() {\r\n    // this.$wrapperEl.find('.CodeMirror-scroll').css('max-height', this.$wrapperEl.css('height'));\r\n    this.codeMirror.refresh();\r\n  }\r\n}\r\n","import NodeAppRunner from '../NodeAppRunner';\r\n\r\nconst htmlEscape = (str) => {\r\n  return String(str).replace(/&/g, '&amp;')\r\n    .replace(/\\\"/g, '&quot;')\r\n    .replace(/'/g, '&#39;')\r\n    .replace(/</g, '&lt;')\r\n    .replace(/>/g, '&gt;');\r\n};\r\n\r\nconst needsJSONConversion = (arg) => {\r\n  if(\r\n    typeof arg === 'number' ||\r\n    typeof arg === 'string' ||\r\n    typeof arg === 'boolean'\r\n  ) {\r\n    return false;\r\n  }\r\n  return true;\r\n};\r\n\r\nexport default class ConsoleElement {\r\n\r\n  constructor(el, options) {\r\n    this.el = el;\r\n    this.$el = $(el);\r\n\r\n    this.nodeAppRunner = new NodeAppRunner();\r\n    this.nodeAppRunner.on('stdout-data', data => this.info([data]));\r\n    this.nodeAppRunner.on('stderr-data', error => this.error([error]));\r\n\r\n    //options\r\n    if(!options) {\r\n      options = {};\r\n    }\r\n    //wrap element in a container\r\n    this.$wrapperEl = $(el).wrap('<div class=\"live-code-element live-code-console-element unreset\"></div>').parent();\r\n    this.wrapperEl = this.$wrapperEl[0];\r\n\r\n    this.id = this.$el.attr('data-id');\r\n    if(!this.id)\r\n    {\r\n      //generate id\r\n      this.id = 'code-' + Math.round(Math.random() * 1000 * new Date().getTime());\r\n      this.$el.attr('data-id', this.id);\r\n    }\r\n\r\n    this.file = this.$el.data('file');\r\n\r\n    this.$el.css('width', '100%').css('height', '100%');\r\n\r\n    this.logs = [];\r\n  }\r\n\r\n  stop() {\r\n    this.nodeAppRunner.stop();\r\n  }\r\n\r\n  destroy() {\r\n    stop();\r\n  }\r\n\r\n  runNodeApp(applicationPath) {\r\n    this.nodeAppRunner.run(applicationPath);\r\n  }\r\n\r\n  info(args) {\r\n    var str = '';\r\n    args.forEach(function(arg){\r\n      if(str.length > 0) {\r\n        str += ' ';\r\n      }\r\n      //is it an object or a simple type?\r\n      if(needsJSONConversion(arg)) {\r\n        arg = JSON.stringify(arg);\r\n      }\r\n      str += htmlEscape(arg);\r\n    });\r\n    this.logs.push('<pre>' + str + '</pre>');\r\n    while(this.logs.length > 20) {\r\n      this.logs.shift();\r\n    }\r\n    var html = this.logs.join('');\r\n    this.el.innerHTML = html;\r\n    this.wrapperEl.scrollTop = this.wrapperEl.scrollHeight;\r\n  }\r\n\r\n  error(args) {\r\n    var str = '';\r\n    args.forEach(function(arg){\r\n      if(str.length > 0) {\r\n        str += ' ';\r\n      }\r\n      //is it an object or a simple type?\r\n      if(needsJSONConversion(arg)) {\r\n        arg = JSON.stringify(arg);\r\n      }\r\n      str += htmlEscape(arg);\r\n    });\r\n    this.logs.push('<pre class=\"console-error\">' + str + '</pre>');\r\n    while(this.logs.length > 20) {\r\n      this.logs.shift();\r\n    }\r\n    var html = this.logs.join('');\r\n    this.el.innerHTML = html;\r\n    this.wrapperEl.scrollTop = this.wrapperEl.scrollHeight;\r\n  }\r\n}\r\n","export default class TerminalElement {\r\n\r\n  constructor(el, options) {\r\n    this.el = el;\r\n    this.$el = $(el);\r\n\r\n    //options\r\n    if(!options) {\r\n      options = {};\r\n    }\r\n    //wrap element in a container\r\n    this.$wrapperEl = $(el).wrap('<div class=\"live-code-element live-code-terminal-element\"></div>').parent();\r\n    this.wrapperEl = this.$wrapperEl[0];\r\n\r\n    this.id = this.$el.attr('data-id');\r\n    if(!this.id)\r\n    {\r\n      //generate id\r\n      this.id = 'code-' + Math.round(Math.random() * 1000 * new Date().getTime());\r\n      this.$el.attr('data-id', this.id);\r\n    }\r\n\r\n    this.dir = this.$el.data('dir');\r\n\r\n    this.$el.css('width', '100%').css('height', '100%');\r\n\r\n    //create a webview tag\r\n    if(this.webview) {\r\n      this.webview.parentNode.removeChild(this.webview);\r\n      this.webview = false;\r\n    }\r\n    this.webview = document.createElement('webview');\r\n    this.webview.style.width = '100%';\r\n    this.webview.style.height = '100%';\r\n    this.el.appendChild(this.webview);\r\n    this.webview.setAttribute('src', 'http://localhost:3000?dir=' + this.dir);\r\n  }\r\n\r\n  stop() {\r\n    if(this.webview) {\r\n      this.webview.parentNode.removeChild(this.webview);\r\n      this.webview = false;\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    stop();\r\n  }\r\n}\r\n","export default class WebPreviewElement {\r\n\r\n\tconstructor(el, options) {\r\n    this.el = el;\r\n    this.$el = $(el);\r\n    //options\r\n    if(!options) {\r\n      options = {};\r\n    }\r\n\t\t//wrap element in a container\r\n\t\tthis.$wrapperEl = $(el).wrap('<div class=\"live-code-element live-code-web-preview-element\"></div>').parent();\r\n\t\tthis.wrapperEl = this.$wrapperEl[0];\r\n\r\n\t\tthis.id = this.$el.attr('data-id');\r\n\t\tif(!this.id)\r\n\t\t{\r\n\t\t\t//generate id\r\n\t\t\tthis.id = 'code-' + Math.round(Math.random() * 1000 * new Date().getTime());\r\n\t\t\tthis.$el.attr('data-id', this.id);\r\n\t\t}\r\n\r\n    this.file = this.$el.data('file');\r\n\r\n\t\tthis.console = this.$el.data('console');\r\n\r\n\t\tthis.$el.css('width', '100%').css('height', '100%');\r\n\t}\r\n\r\n\tdestroy() {\r\n    stop();\r\n\t}\r\n\r\n  stop() {\r\n    if(this.webview) {\r\n      this.webview.parentNode.removeChild(this.webview);\r\n      this.webview = false;\r\n    }\r\n  }\r\n\r\n  _createWebview() {\r\n    //create a webview tag\r\n    if(this.webview) {\r\n      this.webview.parentNode.removeChild(this.webview);\r\n      this.webview = false;\r\n    }\r\n    this.webview = document.createElement('webview');\r\n    this.webview.style.width = '100%';\r\n    this.webview.style.height = '100%';\r\n    this.webview.preload = 'js/webpreview.js';\r\n    this.el.appendChild(this.webview);\r\n  }\r\n\r\n  updateUrl(url) {\r\n    this._createWebview();\r\n    this.webview.addEventListener(\"dom-ready\", (function(){\r\n      //inject console logging code\r\n      console.log('dom-ready');\r\n    }).bind(this));\r\n\r\n    this.webview.addEventListener('ipc-message', (function(event) {\r\n      if(event.channel === 'console.log')\r\n      {\r\n        //notify live code editor\r\n        this.$wrapperEl.trigger('console.log', event.args[0]);\r\n      }\r\n      else if(event.channel === 'console.error')\r\n      {\r\n        //notify live code editor\r\n        this.$wrapperEl.trigger('console.error', event.args[0]);\r\n      }\r\n    }).bind(this));\r\n\r\n    this.webview.setAttribute('nodeintegration', '');\r\n    this.webview.setAttribute('src', url);\r\n  }\r\n\r\n\tupdateCode(blocks) {\r\n\t\tthis._createWebview();\r\n\r\n\t\tvar htmlSrc = '';\r\n\t\tfor(var i = 0; i < blocks.length; i++)\r\n\t\t{\r\n\t\t\thtmlSrc += blocks[i].code;\r\n\t\t}\r\n\r\n\t\tthis.webview.addEventListener(\"dom-ready\", (function(){\r\n      if(this.$el.attr('data-open-devtools')) {\r\n        this.webview.openDevTools();\r\n      }\r\n\t\t}).bind(this));\r\n\r\n\t\tthis.webview.addEventListener('ipc-message', (function(event) {\r\n      if(event.channel === 'request-html')\r\n      {\r\n        this.webview.send('receive-html', htmlSrc);\r\n      }\r\n      else if(event.channel === 'console.log')\r\n      {\r\n        //notify live code editor\r\n        this.$wrapperEl.trigger('console.log', event.args[0]);\r\n      }\r\n      else if(event.channel === 'console.error')\r\n      {\r\n        //notify live code editor\r\n        this.$wrapperEl.trigger('console.error', event.args[0]);\r\n      }\r\n    }).bind(this));\r\n\r\n\t\tthis.webview.setAttribute('nodeintegration', '');\r\n\t\tthis.webview.setAttribute('src', 'webpreview.html');\r\n\t}\r\n}\r\n","import ConsoleElement from './ConsoleElement';\r\nimport TerminalElement from './TerminalElement';\r\nimport CodeElement from './CodeElement';\r\nimport WebPreviewElement from './WebPreviewElement';\r\n\r\nconst path = requireNode('path');\r\nconst fs = requireNode('fs-promise');\r\n\r\nexport default class LiveCode {\r\n\r\n  constructor($el, config, readyCallback) {\r\n    this.$el = $el;\r\n    this.el = this.$el[0];\r\n\r\n    if(this.$el.attr('data-entry-path')) {\r\n      this.entryPath = path.join(config.presentationPath, this.$el.attr('data-entry-path'));\r\n    }\r\n    if(this.$el.attr('data-output-path')) {\r\n      this.outputPath = path.join(config.presentationPath, this.$el.attr('data-output-path'));\r\n    } else {\r\n      if(this.entryPath) {\r\n        this.outputPath = this.entryPath;\r\n      }\r\n    }\r\n\r\n    let p = Promise.resolve();\r\n    p.then(() => {\r\n      if(this.entryPath && this.entryPath !== this.outputPath) {\r\n        return fs.copy(this.entryPath, this.outputPath);\r\n      }\r\n    })\r\n    .then(() => {\r\n      //create the consoles\r\n      this.consoleElements = {};\r\n      this.$el.find('[data-type=\"console\"]').each(((index, consoleEl) => this.createConsoleElement(consoleEl)));\r\n\r\n      //create the terminals\r\n      this.terminalElements = {};\r\n      this.$el.find('[data-type=\"terminal\"]').each(((index, terminalEl) => this.createTerminalElement(terminalEl)));\r\n\r\n      //create the previews\r\n      this.webPreviewElements = {};\r\n      this.$el.find('[data-type=\"web-preview\"]').each(((index, webPreviewEl) => this.createWebPreviewElement(webPreviewEl)));\r\n\r\n      //create the code editors\r\n      this.codeElements = {};\r\n      this.$el.find('[data-type=\"code\"]').each(((index, codeEl) => this.createCodeElement(codeEl)));\r\n\r\n      //create run buttons\r\n      this.runButtonEls = [];\r\n      this.$el.find('[data-type=\"run-button\"]').each(((index, runButtonEl) => this.createRunButton(runButtonEl)));\r\n\r\n      //create save buttons\r\n      this.saveButtonEls = [];\r\n      this.$el.find('[data-type=\"save-button\"]').each(((index, saveButtonEl) => this.createSaveButton(saveButtonEl)));\r\n\r\n      //create reload buttons\r\n      this.reloadButtonEls = [];\r\n      this.$el.find('[data-type=\"reload-button\"]').each(((index, reloadButtonEl) => this.createReloadButton(reloadButtonEl)));\r\n\r\n    })\r\n    .then(() => this.setCodeElementValuesFromFiles())\r\n    .then(readyCallback).catch(err => console.log(err));\r\n\r\n    //disable keyboard bubbling up\r\n    $(window).on('keydown', event => this.keyDownHandler(event));\r\n  }\r\n\r\n  keyDownHandler(e) {\r\n    if(this.el.contains(document.activeElement)) {\r\n      e.stopImmediatePropagation();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * return a previously created code element, based on the input\r\n   * input can be:\r\n   *  - html dom element\r\n   *  - id of code element\r\n   *\r\n   * returns the code element if found, otherwise returns false\r\n   */\r\n  getCodeElement(input) {\r\n    let propertyToCheck = 'id';\r\n    if(input.nodeName) {\r\n      propertyToCheck = 'el';\r\n    }\r\n    for(let key in this.codeElements)\r\n    {\r\n      if(this.codeElements[key][propertyToCheck] === input) {\r\n        return this.codeElements[key];\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  setCodeElementValueFromFile(codeElement, filePath) {\r\n    return codeElement.readFromFile(filePath);\r\n  }\r\n\r\n  saveCodeElementToFile(codeElement, filePath) {\r\n    return codeElement.saveToFile(filePath);\r\n  }\r\n\r\n  getFilePath(file) {\r\n    if(!file) {\r\n      return false;\r\n    }\r\n    if(this.outputPath) {\r\n      return path.join(this.outputPath, file);\r\n    }\r\n    return file;\r\n  }\r\n\r\n  getFilePathForCodeElement(codeElement) {\r\n    if(!codeElement.file) {\r\n      return false;\r\n    }\r\n    return this.getFilePath(codeElement.file);\r\n  }\r\n\r\n  setCodeElementValuesFromFiles() {\r\n    let tasks = [];\r\n    let key;\r\n    let codeElement;\r\n    let filePath;\r\n    for(key in this.codeElements)\r\n    {\r\n      codeElement = this.codeElements[key];\r\n      filePath = this.getFilePathForCodeElement(codeElement);\r\n      if(filePath)\r\n      {\r\n        tasks.push(this.setCodeElementValueFromFile(codeElement, filePath));\r\n      }\r\n    }\r\n    return Promise.all(tasks);\r\n  }\r\n\r\n  saveCodeElementsToFiles() {\r\n    let tasks = [];\r\n    let key;\r\n    let codeElement;\r\n    let filePath;\r\n    for(key in this.codeElements)\r\n    {\r\n      codeElement = this.codeElements[key];\r\n      filePath = this.getFilePathForCodeElement(codeElement);\r\n      if(filePath)\r\n      {\r\n        tasks.push(this.saveCodeElementToFile(codeElement, filePath));\r\n      }\r\n    }\r\n    return Promise.all(tasks);\r\n  }\r\n\r\n  destroy() {\r\n    let key;\r\n    for(key in this.consoleElements)\r\n    {\r\n      this.destroyConsoleElement(this.consoleElements[key]);\r\n    }\r\n    for(key in this.terminalElements)\r\n    {\r\n      this.destroyTerminalElement(this.terminalElements[key]);\r\n    }\r\n    for(key in this.webPreviewElements)\r\n    {\r\n      this.destroyWebPreviewElement(this.webPreviewElements[key]);\r\n    }\r\n    for(key in this.codeElements)\r\n    {\r\n      this.destroyCodeElement(this.codeElements[key]);\r\n    }\r\n    this.runButtonEls.forEach(el => this.destroyRunButton(el));\r\n    this.saveButtonEls.forEach(el => this.destroySaveButton(el));\r\n    this.reloadButtonEls.forEach(el => this.destroyReloadButton(el));\r\n    //TODO: destroy the tmp directory for this instance\r\n  }\r\n\r\n  stop() {\r\n    let key;\r\n    for(key in this.consoleElements)\r\n    {\r\n      this.consoleElements[key].stop();\r\n    }\r\n    for(key in this.terminalElements)\r\n    {\r\n      this.terminalElements[key].stop();\r\n    }\r\n    for(key in this.webPreviewElements)\r\n    {\r\n      this.webPreviewElements[key].stop();\r\n    }\r\n    for(key in this.codeElements)\r\n    {\r\n      this.codeElements[key].stop();\r\n    }\r\n  }\r\n\r\n  layout() {\r\n    //might be triggered after split pane resize or tab switch\r\n    //codemirror instances need to be updated\r\n    for(let key in this.codeElements)\r\n    {\r\n      this.codeElements[key].layout();\r\n    }\r\n  }\r\n\r\n  createConsoleElement(consoleEl) {\r\n    let consoleElement = new ConsoleElement(consoleEl);\r\n    this.consoleElements[consoleElement.id] = consoleElement;\r\n  }\r\n\r\n  destroyConsoleElement(consoleElement) {\r\n    consoleElement.destroy();\r\n  }\r\n\r\n  createTerminalElement(terminalEl) {\r\n    let terminalElement = new TerminalElement(terminalEl);\r\n    this.terminalElements[terminalElement.id] = terminalElement;\r\n  }\r\n\r\n  destroyTerminalElement(terminalElement) {\r\n    terminalElement.destroy();\r\n  }\r\n\r\n  createWebPreviewElement(webPreviewEl) {\r\n    let webPreviewElement = new WebPreviewElement(webPreviewEl);\r\n    webPreviewElement.$wrapperEl.on('console.log', this.webPreviewConsoleLogHandler.bind(this, webPreviewElement));\r\n    webPreviewElement.$wrapperEl.on('console.error', this.webPreviewConsoleErrorHandler.bind(this, webPreviewElement));\r\n    this.webPreviewElements[webPreviewElement.id] = webPreviewElement;\r\n  }\r\n\r\n  destroyWebPreviewElement(webPreviewElement) {\r\n    webPreviewElement.$wrapperEl.off('console.log');\r\n    webPreviewElement.$wrapperEl.off('console.error');\r\n    webPreviewElement.destroy();\r\n  }\r\n\r\n  createCodeElement(codeEl) {\r\n    let codeElement = new CodeElement(codeEl);\r\n    this.codeElements[codeElement.id] = codeElement;\r\n  }\r\n\r\n  destroyCodeElement(codeElement) {\r\n    codeElement.destroy();\r\n  }\r\n\r\n  createRunButton(runButtonEl) {\r\n    this.runButtonEls.push(runButtonEl);\r\n    $(runButtonEl).on('click', (event => {\r\n      if(this.webPreviewElements[$(runButtonEl).data('target')]) {\r\n        //save the files first\r\n        this.saveCodeElementsToFiles()\r\n          .catch(err =>console.log(err))\r\n          .then(() => {\r\n            //update the web preview\r\n            this.updateWebPreviewElement(this.webPreviewElements[$(runButtonEl).data('target')]);\r\n          });\r\n      } else if(this.consoleElements[$(runButtonEl).data('target')]) {\r\n        let applicationPath = this.getFilePath(this.consoleElements[$(runButtonEl).data('target')].file);\r\n        this.consoleElements[$(runButtonEl).data('target')].runNodeApp(applicationPath);\r\n      }\r\n    }));\r\n  }\r\n\r\n  destroyRunButton(runButtonEl) {\r\n    $(runButtonEl).off('click');\r\n  }\r\n\r\n  createSaveButton(saveButtonEl) {\r\n    var self = this;\r\n    this.saveButtonEls.push(saveButtonEl);\r\n    $(saveButtonEl).on('click', (function(){\r\n      //get the code element for this reload button\r\n      var codeElement = self.getCodeElement($(saveButtonEl).data('target'));\r\n      if(!codeElement) {\r\n        return;\r\n      }\r\n      var filePath = self.getFilePathForCodeElement(codeElement);\r\n      if(!filePath) {\r\n        return;\r\n      }\r\n      codeElement.saveToFile(filePath).catch(function(err) { console.log(err); });\r\n    }).bind(this));\r\n  }\r\n\r\n  destroySaveButton(saveButtonEl) {\r\n    $(saveButtonEl).off('click');\r\n  }\r\n\r\n  createReloadButton(reloadButtonEl) {\r\n    var self = this;\r\n    this.reloadButtonEls.push(reloadButtonEl);\r\n    $(reloadButtonEl).on('click', (function(){\r\n      //get the code element for this reload button\r\n      var codeElement = self.getCodeElement($(reloadButtonEl).data('target'));\r\n      if(!codeElement) {\r\n        return;\r\n      }\r\n      var filePath = self.getFilePathForCodeElement(codeElement);\r\n      if(!filePath) {\r\n        return;\r\n      }\r\n      codeElement.readFromFile(filePath).catch(function(err) { console.log(err); });\r\n    }).bind(this));\r\n  }\r\n\r\n  destroyReloadButton(reloadButtonEl) {\r\n    $(reloadButtonEl).off('click');\r\n  }\r\n\r\n  webPreviewConsoleLogHandler(webPreviewElement, event, message) {\r\n    //get the console element for this web preview\r\n    var consoleElement = this.getConsoleElementForWebPreview(webPreviewElement);\r\n    if(consoleElement)\r\n    {\r\n      consoleElement.info(JSON.parse(message).args);\r\n    }\r\n  }\r\n\r\n  webPreviewConsoleErrorHandler(webPreviewElement, event, message) {\r\n    //get the console element for this web preview\r\n    var consoleElement = this.getConsoleElementForWebPreview(webPreviewElement);\r\n    if(consoleElement)\r\n    {\r\n      consoleElement.error(JSON.parse(message).args);\r\n    }\r\n  }\r\n\r\n  getConsoleElementForWebPreview(webPreviewElement) {\r\n    return this.consoleElements[webPreviewElement.console];\r\n  }\r\n\r\n  getWebPreviewElementForCodeElement(codeElement) {\r\n    return this.webPreviewElements[codeElement.processor];\r\n  }\r\n\r\n  updateWebPreviewElement(webPreviewElement) {\r\n    //load a file or code blocks?\r\n    if(webPreviewElement.file) {\r\n      if(this.outputPath) {\r\n        webPreviewElement.updateUrl(path.join(this.outputPath, webPreviewElement.file));\r\n      } else {\r\n        webPreviewElement.updateUrl(webPreviewElement.file);\r\n      }\r\n      return;\r\n    }\r\n\r\n    //gather all the code for this element\r\n    var blocks = [];\r\n    for(var key in this.codeElements)\r\n    {\r\n      var codeElement = this.codeElements[key];\r\n      if(codeElement.processor === webPreviewElement.id)\r\n      {\r\n        var block = {\r\n          language: codeElement.language,\r\n          code: codeElement.getValue()\r\n        };\r\n        blocks.push(block);\r\n      }\r\n    }\r\n    webPreviewElement.updateCode(blocks);\r\n  }\r\n\r\n}\r\n","import Presentation from './classes/Presentation';\r\nimport SlidesFolderParser from '../../server/classes/SlidesFolderParser';\r\n\r\n(() => {\r\n\r\n  const remote = requireNode('electron').remote;\r\n  const presentationPath = remote.getGlobal('__dirname');\r\n  const path = requireNode('path');\r\n\r\n  const init = () => {\r\n    let settings = {\r\n      presentationPath: presentationPath,\r\n      mobileServerUrl: 'http://localhost:5000',\r\n      mobileServerUsername: 'wouter.verweirder@gmail.com',\r\n      mobileServerPassword: 'geheim'\r\n    };\r\n    let slidesFolderParser = new SlidesFolderParser();\r\n    slidesFolderParser.parse(presentationPath, path.resolve(presentationPath, 'slides'))\r\n      .then(data => {\r\n        new Presentation(data, 'presentation', settings);\r\n      });\r\n  };\r\n\r\n  init();\r\n})();\r\n","if(!(typeof window !== 'undefined' && window)) {\r\n  var requireNode = require;\r\n} else {\r\n  var requireNode = window.requireNode;\r\n}\r\n\r\nconst fs = requireNode('fs-promise');\r\nconst path = requireNode('path');\r\n\r\nconst getFileProperties = filePath => {\r\n  let _fd, _o;\r\n  return fs.open(filePath, 'r')\r\n    .then(fd => {\r\n      _fd = fd;\r\n      return fd;\r\n    })\r\n    .then(fd => fs.fstat(fd))\r\n    .then(o => {\r\n      _o = o;\r\n      return _o;\r\n    })\r\n    .then(o => fs.close(_fd))\r\n    .then(() => {\r\n      return {\r\n        path: filePath,\r\n        isDirectory: _o.isDirectory(),\r\n        isFile: _o.isFile()\r\n      };\r\n    });\r\n};\r\nexport default class SlidesFolderParser {\r\n  constructor() {\r\n  }\r\n  parse(presentationPath, slidesFolderPath) {\r\n    //read the contents of the slides directory\r\n    return fs.readdir(slidesFolderPath)\r\n      .then(result => result.filter(name => name.indexOf('.') > 0))\r\n      .then(result => result.map(name => path.resolve(slidesFolderPath, name)))\r\n      .then(result => Promise.all(result.map(filePath => getFileProperties(filePath))))\r\n      .then(result => {\r\n        let data = {\r\n          slides: []\r\n        };\r\n        let slidesByName = {};\r\n        result.forEach(props => {\r\n          let slide = this.createSlideObjectBasedOnFileProperties(props, presentationPath, slidesByName);\r\n          if(!slidesByName[slide.name]) {\r\n            data.slides.push(slide);\r\n          }\r\n          slidesByName[slide.name] = slide;\r\n        });\r\n        console.log(data.slides);\r\n        return data;\r\n      });\r\n  }\r\n\r\n  getPresentationVersionIfExists(fileProperties, presentationPath, slidesByName){\r\n    let ext = path.extname(fileProperties.path);\r\n    let pathWithoutExtension = fileProperties.path.substr(0, fileProperties.path.length - ext.length);\r\n    let typeExt = path.extname(pathWithoutExtension);\r\n    if(typeExt === '.mobile') {\r\n      //this might be an alternative mobile view of an existing slide\r\n      let nameOfPresentationVersionWithoutExtension = path.basename(pathWithoutExtension.substr(0, pathWithoutExtension.length - typeExt.length));\r\n      return slidesByName[nameOfPresentationVersionWithoutExtension];\r\n    }\r\n    return false;\r\n  }\r\n\r\n  getMobileVersionIfExists(fileProperties, presentationPath, slidesByName){\r\n    let ext = path.extname(fileProperties.path);\r\n    let pathWithoutExtension = fileProperties.path.substr(0, fileProperties.path.length - ext.length);\r\n    let nameOfMobileVersionWithoutExtension = path.basename(pathWithoutExtension) + '.mobile';\r\n    return slidesByName[nameOfMobileVersionWithoutExtension];\r\n  }\r\n\r\n  createSlideObjectBasedOnFileProperties(fileProperties, presentationPath, slidesByName) {\r\n    let ext = path.extname(fileProperties.path);\r\n    let nameWithoutExtension = path.basename(fileProperties.path.substr(0, fileProperties.path.length - ext.length));\r\n    let slide = {\r\n      path: fileProperties.path,\r\n      name: nameWithoutExtension,\r\n      presentation: {\r\n        url: path.relative(presentationPath, fileProperties.path),\r\n      },\r\n      mobile: {\r\n        url: path.relative(presentationPath, fileProperties.path),\r\n      }\r\n    };\r\n\r\n    if(ext === '.jpg' || ext === '.gif' || ext === '.png') {\r\n      slide.presentation.url = 'slides-builtin/image.html?image=' + slide.presentation.url;\r\n    }\r\n    if(ext === '.mp4') {\r\n      slide.presentation.url = 'slides-builtin/video.html?video=' + slide.presentation.url;\r\n    }\r\n    slide.mobile.url = slide.presentation.url;\r\n\r\n    let presentationVersion = this.getPresentationVersionIfExists(fileProperties, presentationPath, slidesByName);\r\n    if(presentationVersion) {\r\n      presentationVersion.mobile.url = slide.mobile.url;\r\n      return presentationVersion;\r\n    }\r\n    let mobileVersion = this.getMobileVersionIfExists(fileProperties, presentationPath, slidesByName);\r\n    if(mobileVersion) {\r\n      mobileVersion.presentation.url = slide.presentation.url;\r\n      return mobileVersion;\r\n    }\r\n\r\n    return slide;\r\n  }\r\n}\r\n","export const Constants = {\r\n  GO_TO_PREVIOUS_SLIDE : 'goToPreviousSlide',\r\n  GO_TO_NEXT_SLIDE : 'goToNextSlide',\r\n  SET_SLIDES : 'setSlides',\r\n  SET_CURRENT_SLIDE_INDEX : 'setCurrentSlideIndex',\r\n\r\n  MESSAGE : 'message',\r\n  SOCKET_SEND : 'socketSend',\r\n  SOCKET_RECEIVE : 'socketReceive',\r\n  JOIN_SLIDE_ROOM : 'joinSlideRoom',\r\n  LEAVE_SLIDE_ROOM : 'leaveSlideRoom',\r\n\r\n  ROLE_PRESENTATION : 'presentation',\r\n  ROLE_MOBILE : 'mobile',\r\n\r\n  STATE_ACTIVE : 'active',\r\n  STATE_INACTIVE : 'inactive',\r\n\r\n  SET_SUBSTATE : 'setSubstate',\r\n\r\n  CHILD_APP_SAVE_CODE : 'childAppSaveCode',\r\n  CHILD_APP_RUN_CODE : 'childAppRunCode',\r\n  CHILD_APP_STDOUT_DATA : 'childAppStdoutData',\r\n  CHILD_APP_STDERR_DATA : 'childAppStderrData',\r\n\r\n  OPEN_COMMAND_LINE: 'openCommandLine',\r\n  OPEN_CAMERA: 'openCamera',\r\n\r\n  SET_TEAM : 'setTeam',\r\n  UPDATE_MOTION : 'updateMotion',\r\n\r\n  YOU_WIN : 'youWin',\r\n  YOU_LOSE : 'youLose',\r\n\r\n  SHAKE_YOUR_PHONES_INTRO : 'shakeYourPhonesIntro',\r\n  SHAKE_YOUR_PHONES_GAME : 'shakeYourPhonesGame',\r\n  SHAKE_YOUR_PHONES_FINISHED : 'shakeYourPhonesFinished',\r\n\r\n  SHAKE_YOUR_PHONES_CLIENT_ADDED : 'shakeYourPhonesClientAdded',\r\n  SHAKE_YOUR_PHONES_CLIENT_REMOVED : 'shakeYourPhonesClientRemoved',\r\n  SHAKE_YOUR_PHONES_CLIENT_LIST : 'shakeYourPhonesClientList',\r\n  SHAKE_YOUR_PHONES_CLIENT_UPDATE : 'shakeYourPhonesClientUpdate'\r\n};\r\n","import {Constants} from '../Constants';\r\n\r\nexport default class ContentBase{\r\n\r\n  constructor($slideHolder) {\r\n    this.$slideHolder = $slideHolder;\r\n    this.src = $slideHolder.attr('data-src');\r\n    this.name = $slideHolder.attr('data-name');\r\n    this.fps = 60;\r\n    this._animationFrameId = false;\r\n    this._currentTime = 0;\r\n    this._delta = 0;\r\n    this._interval = false;\r\n    this._lastTime = new Date().getTime();\r\n    this.currentFrame = 0;\r\n\r\n    this.startListeningForMessages();\r\n\r\n    this.__drawLoop = this._drawLoop.bind(this);\r\n    this._interval = 1000 / this.fps;\r\n\r\n    window.requestAnimationFrame(() => {\r\n      $slideHolder.trigger('load');\r\n    });\r\n  }\r\n\r\n  startListeningForMessages() {\r\n    this._slideHolderMessageToSlideHandler = this.slideHolderMessageToSlideHandler.bind(this);\r\n    this.$slideHolder.on('message-to-slide', this._slideHolderMessageToSlideHandler);\r\n  }\r\n\r\n  stopListeningForMessages() {\r\n    this.$slideHolder.off('message-to-slide', this._slideHolderMessageToSlideHandler);\r\n  }\r\n\r\n  slideHolderMessageToSlideHandler(event, message) {\r\n    this.receiveMessage({data: message});\r\n  }\r\n\r\n  receiveMessage(event) {\r\n    if(!event.data) {\r\n      return;\r\n    }\r\n    switch(event.data.action) {\r\n      case 'setState':\r\n        this.setState(event.data.state);\r\n        break;\r\n      case 'destroy':\r\n        this.destroy();\r\n        break;\r\n      case Constants.SOCKET_RECEIVE:\r\n        this.receiveSocketMessage(event.data.message);\r\n        break;\r\n      default:\r\n        this.handleMessage(event.data);\r\n        break;\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    this.stopListeningForMessages();\r\n    window.cancelAnimationFrame(this._animationFrameId);\r\n  }\r\n\r\n  postMessage(data) {\r\n    this.$slideHolder.trigger('message-from-slide', data);\r\n  }\r\n\r\n  handleMessage(data) {\r\n  }\r\n\r\n  postSocketMessage(message) {\r\n    this.postMessage({\r\n      action: Constants.SOCKET_SEND,\r\n      message: message\r\n    });\r\n  }\r\n\r\n  receiveSocketMessage(message) {\r\n    //console.log('receiveSocketMessageame, message);\r\n  }\r\n\r\n  setState(state) {\r\n    if(state !== this.state) {\r\n      this.state = state;\r\n      this.onStateChanged();\r\n      if(this.state === Constants.STATE_ACTIVE) {\r\n        this.currentFrame = 0;\r\n        this._drawLoop();\r\n      } else {\r\n        window.cancelAnimationFrame(this._animationFrameId);\r\n      }\r\n    }\r\n  }\r\n\r\n  onStateChanged() {\r\n  }\r\n\r\n  _drawLoop() {\r\n    this._animationFrameId = window.requestAnimationFrame(this.__drawLoop);\r\n    this._currentTime = (new Date()).getTime();\r\n      this._delta = (this._currentTime - this._lastTime);\r\n      if(this._delta > this._interval) {\r\n        this.currentFrame++;\r\n        this.drawLoop(this._delta);\r\n        this._lastTime = this._currentTime - (this._delta % this._interval);\r\n      }\r\n  }\r\n\r\n  drawLoop(delta) {\r\n  }\r\n\r\n}\r\n","export default class MobileServerBridge {\r\n\r\n  constructor(presentation, settings) {\r\n    this.presentation = presentation;\r\n    this.settings = settings;\r\n    this.connect();\r\n  }\r\n\r\n  connect() {\r\n    console.log('MobileServerBridge.connect');\r\n    $.post(this.settings.mobileServerUrl + '/login', this.getLoginCredentials()).done(this.loginHandler.bind(this))\r\n    .fail((function() {\r\n      //retry after one second\r\n      setTimeout((function(){\r\n        this.connect();\r\n      }).bind(this), 1000);\r\n    }).bind(this));\r\n  }\r\n\r\n  getLoginCredentials() {\r\n    return {\r\n      email: this.settings.mobileServerUsername,\r\n      password: this.settings.mobileServerPassword,\r\n    };\r\n  }\r\n\r\n  loginHandler(result) {\r\n    this.token = result.token;\r\n    this.socket = io(this.settings.mobileServerUrl, {\r\n      query: 'token=' + this.token,\r\n      reconnection: false,\r\n      forceNew: true\r\n    });\r\n    this.socket.on('connect', this.socketConnectHandler.bind(this));\r\n    this.socket.on('disconnect', this.socketDisconnectHandler.bind(this));\r\n    this.socket.on('message', this.socketMessageHandler.bind(this));\r\n  }\r\n\r\n  socketConnectHandler() {\r\n    console.log('MobileServerBridge.socketConnectHandler');\r\n    this.presentation.mobileServerBridgeConnected();\r\n  }\r\n\r\n  socketDisconnectHandler() {\r\n    this.connect();\r\n  }\r\n\r\n  tryToSend() {\r\n    if(this.socket) {\r\n      this.socket.emit.apply(this.socket, arguments);\r\n    }\r\n  }\r\n\r\n  socketMessageHandler(message) {\r\n    this.presentation.mobileServerMessageHandler(message);\r\n  }\r\n}\r\n","import {Constants} from '../Constants';\r\nimport SlideBridge from './SlideBridge';\r\n\r\nexport default class Presentation {\r\n  /*\r\n   * data: json object with slides array property\r\n   * role: mobile or presentation\r\n   */\r\n  constructor(data, role, settings) {\r\n    this.data = data;\r\n    this.role = role;\r\n    this.settings = settings;\r\n    this.currentSlideIndex = -1;\r\n    this.slideHolders = [];\r\n    this.numSlideHolders = 3;\r\n    this.slideBridges = [];\r\n    this.slideBridgesBySlideName = {};\r\n\r\n    this.createSlideHolders();\r\n    this.createSlideBridges(this.data);\r\n\r\n    this.mobileServerBridge = this.createMobileServerBridge();\r\n    this.startListeningForMessages();\r\n\r\n    this.setCurrentSlideIndex(0);\r\n  }\r\n\r\n  startListeningForMessages() {\r\n    window.addEventListener(\"message\", this.slideMessageHandler.bind(this), false);\r\n  };\r\n\r\n  createSlideHolders() {\r\n    for(var i = 0; i < this.numSlideHolders; i++) {\r\n      var $slideHolder = $('<div class=\"slide-frame\" />');\r\n      this.slideHolders.push($slideHolder);\r\n      $('#presentation').append($slideHolder);\r\n    }\r\n  };\r\n\r\n  createSlideBridges(data) {\r\n    var that = this;\r\n    var numSlides = data.slides.length;\r\n    for(var i = 0; i < numSlides; i++) {\r\n      var slideBridge = this.createSlideBridge(data.slides[i]);\r\n      this.slideBridges.push(slideBridge);\r\n      this.slideBridgesBySlideName[slideBridge.name] = slideBridge;\r\n    }\r\n  };\r\n\r\n  createSlideBridge(slide) {\r\n    return new SlideBridge(slide);\r\n  };\r\n\r\n  slideMessageHandler(event) {\r\n    if(!event.data) {\r\n      return;\r\n    }\r\n    switch(event.data.action) {\r\n      case Constants.SOCKET_SEND:\r\n        if(this.mobileServerBridge) {\r\n          this.mobileServerBridge.tryToSend(Constants.MESSAGE, event.data.message);\r\n        }\r\n        break;\r\n    }\r\n  };\r\n\r\n  mobileServerBridgeConnected() {\r\n    //join the rooms of the slideHolders\r\n    for(var i = 0; i < this.numSlideHolders; i++) {\r\n      this.mobileServerBridge.tryToSend(Constants.JOIN_SLIDE_ROOM, $(this.slideHolders[i]).attr('data-name'));\r\n    }\r\n  };\r\n\r\n  mobileServerMessageHandler(message) {\r\n    if(message.target.slide) {\r\n      //slide has to handle the message\r\n      var slideBridge = this.getSlideBridgeByName(message.target.slide);\r\n      if(slideBridge) {\r\n        slideBridge.tryToPostMessage({\r\n          action: Constants.SOCKET_RECEIVE,\r\n          message: message\r\n        });\r\n      }\r\n    } else {\r\n      //presentation has to handle the message\r\n      this.handleMobileServerMessage(message);\r\n    }\r\n  };\r\n\r\n  handleMobileServerMessage(message) {\r\n    console.log('[shared/Presentation] handleMobileServerMessage', message);\r\n  };\r\n\r\n  getSlideBridgeByIndex(index) {\r\n    if(index >= 0 && index < this.slideBridges.length) {\r\n      return this.slideBridges[index];\r\n    }\r\n    return false;\r\n  };\r\n\r\n  getSlideBridgeByName(slideName) {\r\n    return this.slideBridgesBySlideName[slideName];\r\n  };\r\n\r\n  getSlideHolderForSlide(slide, slidesNotToClear) {\r\n    if(slide) {\r\n      var $slideHolder = $('.slide-frame[data-name=\"' + slide.name + '\"]');\r\n      if($slideHolder.length > 0) {\r\n        return $slideHolder[0];\r\n      }\r\n      //get a free slideHolder\r\n      var slideNamesNotToClear = [];\r\n      $(slidesNotToClear).each(function(index, obj){\r\n        slideNamesNotToClear.push(obj.name);\r\n      });\r\n      var $slideHolders = $('.slide-frame');\r\n      for (var i = $slideHolders.length - 1; i >= 0; i--) {\r\n        $slideHolder = $($slideHolders[i]);\r\n        var name = $slideHolder.attr('data-name');\r\n        if(!name || slideNamesNotToClear.indexOf(name) === -1) {\r\n          return $slideHolder[0];\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n\r\n  goToPreviousSlide() {\r\n    this.setCurrentSlideIndex(this.currentSlideIndex - 1);\r\n  };\r\n\r\n  goToNextSlide() {\r\n    this.setCurrentSlideIndex(this.currentSlideIndex + 1);\r\n  };\r\n\r\n  setCurrentSlideIndex(value) {\r\n    value = Math.max(0, Math.min(value, this.slideBridges.length - 1));\r\n    if(value !== this.currentSlideIndex) {\r\n      this.currentSlideIndex = value;\r\n\r\n      var currentSlideBridge = this.getSlideBridgeByIndex(this.currentSlideIndex);\r\n      var previousSlideBridge = this.getSlideBridgeByIndex(this.currentSlideIndex - 1);\r\n      var nextSlideBridge = this.getSlideBridgeByIndex(this.currentSlideIndex + 1);\r\n\r\n      //remove \"used\" class from slide holders\r\n      $('.slide-frame').removeAttr('data-used', false);\r\n\r\n      var currentSlideHolder = this.getSlideHolderForSlide(currentSlideBridge, [previousSlideBridge, nextSlideBridge]);\r\n      this.setupSlideHolder(currentSlideHolder, currentSlideBridge, Constants.STATE_ACTIVE, 0);\r\n\r\n      var previousSlideHolder = this.getSlideHolderForSlide(previousSlideBridge, [currentSlideBridge, nextSlideBridge]);\r\n      this.setupSlideHolder(previousSlideHolder, previousSlideBridge, Constants.STATE_INACTIVE, '-100%');\r\n\r\n      var nextSlideHolder = this.getSlideHolderForSlide(nextSlideBridge, [previousSlideBridge, currentSlideBridge]);\r\n      this.setupSlideHolder(nextSlideHolder, nextSlideBridge, Constants.STATE_INACTIVE, '100%');\r\n\r\n      //clear attributes of unused slide frames\r\n      $('.slide-frame').each(function(index, slideHolder){\r\n        if(!$(slideHolder).attr('data-used')) {\r\n          $(slideHolder).removeAttr('data-used').removeAttr('data-name').removeAttr('data-src');\r\n        }\r\n      });\r\n\r\n      //all other slideHolder bridges should be unlinked from their slideHolder\r\n      this.slideBridges.forEach(function(slideBridge){\r\n        if(slideBridge === currentSlideBridge) {\r\n          return;\r\n        }\r\n        if(slideBridge === previousSlideBridge) {\r\n          return;\r\n        }\r\n        if(slideBridge === nextSlideBridge) {\r\n          return;\r\n        }\r\n        slideBridge.slideHolder = null;\r\n      });\r\n\r\n      bean.fire(this, Constants.SET_CURRENT_SLIDE_INDEX, [this.currentSlideIndex]);\r\n    }\r\n  };\r\n\r\n  setupSlideHolder(slideHolder, slideBridge, state, left) {\r\n    if(slideHolder) {\r\n      var src = \"slides/\" + slideBridge.name + '.html';\r\n      if(slideBridge.data[this.role] && slideBridge.data[this.role].url) {\r\n        src = slideBridge.data[this.role].url;\r\n      }\r\n      src = this.processSlideSrc(src);\r\n      if(slideBridge.isAlreadyCorrectlyAttached(slideHolder, src)) {\r\n        //console.log(slideBridge.name + ' already attached');\r\n      } else {\r\n        this.attachToSlideHolder(slideHolder, slideBridge, src);\r\n      }\r\n      slideBridge.setState(state);\r\n      $(slideHolder).css('left', left);\r\n      $(slideHolder).attr('data-used', 1);\r\n    }\r\n  };\r\n\r\n  attachToSlideHolder(slideHolder, slideBridge, src) {\r\n    //listen for events on this slideHolder\r\n    $(slideHolder).off('message-from-slide');\r\n    $(slideHolder).on('message-from-slide', (function(event, message) {\r\n      this.slideMessageHandler({data: message});\r\n    }).bind(this));\r\n    //leave previous channel of this slideHolder\r\n    if(this.mobileServerBridge) {\r\n      this.mobileServerBridge.tryToSend(Constants.LEAVE_SLIDE_ROOM, $(slideHolder).attr('data-name'));\r\n    }\r\n    //add the join as a callback for the onload event\r\n    slideBridge.attachToSlideHolder(slideHolder, src, this.slideLoaded.bind(this, slideHolder, slideBridge, src));\r\n  };\r\n\r\n  slideLoaded(slideHolder, slideBridge) {\r\n    //join new channel\r\n    if(this.mobileServerBridge) {\r\n      this.mobileServerBridge.tryToSend(Constants.JOIN_SLIDE_ROOM, $(slideHolder).attr('data-name'));\r\n    }\r\n  };\r\n\r\n  processSlideSrc(src) {\r\n    return src;\r\n  };\r\n\r\n  createMobileServerBridge() {\r\n    //to implement in extending classes\r\n  };\r\n}\r\n","import fetch from 'isomorphic-fetch';\r\n\r\nexport default class SlideBridge {\r\n  constructor(data) {\r\n    this.data = data;\r\n    this.name = this.data.name;\r\n  }\r\n\r\n  isAlreadyCorrectlyAttached(slideHolder, src) {\r\n    return (this.slideHolder === slideHolder && $(slideHolder).attr('data-name') === this.name && $(slideHolder).attr('data-src') === src);\r\n  };\r\n\r\n  attachToSlideHolder(slideHolder, src, cb) {\r\n    this.slideHolder = slideHolder;\r\n    //notify the content it is being cleared\r\n    this.tryToPostMessage({action: 'destroy'});\r\n    //clear the current content\r\n    this.slideHolder.innerHTML = '';\r\n    $(slideHolder).attr('data-name', this.name);\r\n    $(slideHolder).addClass('loading');\r\n\r\n    $(slideHolder).on('load', () => {\r\n      this.tryToPostMessage({\r\n        action: 'setState',\r\n        state: this.state\r\n      });\r\n      $(slideHolder).off('load');\r\n    });\r\n\r\n    if(src !== $(slideHolder).attr('data-src')) {\r\n      //fetch the html\r\n      fetch(src)\r\n        .then(result => result.text())\r\n        .then(result => $(result))\r\n        .then($result => {\r\n          $(slideHolder).html($result.html());\r\n          $(slideHolder).removeClass('loading');\r\n          cb();\r\n        })\r\n        .catch(err => {\r\n          console.error(err);\r\n          $(slideHolder).removeClass('loading');\r\n          cb();\r\n        });\r\n      $(slideHolder).attr('data-src', src);\r\n    }\r\n  };\r\n\r\n  tryToPostMessage(message) {\r\n    if(!this.slideHolder)\r\n    {\r\n      return;\r\n    }\r\n    //trigger with jquery\r\n    $(this.slideHolder).trigger('message-to-slide', message);\r\n  };\r\n\r\n  setState(state) {\r\n    this.state = state;\r\n    this.tryToPostMessage({\r\n      action: 'setState',\r\n      state: this.state\r\n    });\r\n  };\r\n}\r\n","import {Constants} from '../../../../shared/js/Constants';\r\nimport ContentBase from '../../../../shared/js/classes/ContentBase';\r\n\r\nimport LiveCode from '../live-code';\r\n\r\nexport default class LiveCodeSlide extends ContentBase {\r\n\r\n  constructor($slideHolder) {\r\n    super($slideHolder);\r\n\r\n    var remote = requireNode('electron').remote;\r\n    var config = {\r\n      presentationPath: remote.getGlobal('__dirname')\r\n    };\r\n\r\n    //find live code element\r\n    this.liveCode = new LiveCode(this.$slideHolder.find('.live-code'), config);\r\n  }\r\n\r\n  layout() {\r\n    this.liveCode.layout();\r\n  }\r\n\r\n  destroy() {\r\n    super.destroy();\r\n    this.liveCode.destroy();\r\n  }\r\n\r\n  onStateChanged() {\r\n    if(this.state === Constants.STATE_ACTIVE) {\r\n    } else {\r\n      //stop\r\n      this.liveCode.stop();\r\n    }\r\n  }\r\n\r\n}\r\n","import {Constants} from '../../../../shared/js/Constants';\r\nimport ContentBase from '../../../../shared/js/classes/ContentBase';\r\n\r\nexport default class MegaPuddingSlide extends ContentBase {\r\n\r\n  constructor($slideHolder) {\r\n    super($slideHolder);\r\n\r\n    this.$webview = $slideHolder.find('webview');\r\n    this.webview = this.$webview[0];\r\n\r\n    this.webview.addEventListener(\"dom-ready\", (function(){\r\n      this.webview.openDevTools();\r\n    }).bind(this));\r\n  }\r\n\r\n  onStateChanged() {\r\n    if(this.state === Constants.STATE_ACTIVE) {\r\n      this.webview.setAttribute('src', 'demos/megapudding/index.html');\r\n    } else {\r\n      this.webview.setAttribute('src', '');\r\n    }\r\n  }\r\n\r\n}\r\n","import {Constants} from '../../../../shared/js/Constants';\r\nimport ContentBase from '../../../../shared/js/classes/ContentBase';\r\n\r\nlet teamColors = [\r\n  '#c6363d', //red\r\n  '#0684AF'  //blue\r\n];\r\n\r\nexport default class ShakeYourPhonesSlide extends ContentBase {\r\n\r\n  constructor($slideHolder) {\r\n    super($slideHolder);\r\n\r\n    this.gameDuration = 13; //game lasts 10 seconds\r\n    this.clientsMap = {};\r\n    this.clientsByTeam = [\r\n      [],\r\n      []\r\n    ];\r\n    this.motions = [0, 0];\r\n    this.music = this.$slideHolder.find('#music')[0];\r\n\r\n    this.$slideHolder.find('#ip').text('bbridges.herokuapp.com');\r\n\r\n    this.$slideHolder.find('.substate-intro .btn').on('click', this.startClickHandler.bind(this));\r\n\r\n    this.$teamBlocks = this.$slideHolder.find('.team');\r\n    this.$teamBlocks.css({\r\n      position: 'absolute',\r\n      height: '100%',\r\n      top: 0\r\n    });\r\n    $(this.$teamBlocks[0]).css('background-color', teamColors[0]);\r\n    $(this.$teamBlocks[1]).css('background-color', teamColors[1]);\r\n    this.displayMotions();\r\n\r\n    this.setSubstate(Constants.SHAKE_YOUR_PHONES_INTRO);\r\n  }\r\n\r\n  setSubstate(substate) {\r\n    if(this.substate !== substate) {\r\n      this.substate = substate;\r\n      //send substate to mobile clients\r\n      this.postSocketMessage({\r\n        target: {\r\n          client: 'mobile',\r\n          slide: this.name\r\n        },\r\n        content: {\r\n          action: Constants.SET_SUBSTATE,\r\n          substate: this.substate\r\n        }\r\n      });\r\n      if(this.substate === Constants.SHAKE_YOUR_PHONES_GAME) {\r\n        this.resetMotion();\r\n      }\r\n      this.showCurrentState();\r\n    }\r\n  }\r\n\r\n  receiveSocketMessage(message) {\r\n    if(!message.content) {\r\n      return;\r\n    }\r\n    if(message.content.action === 'updateRoomList') {\r\n      //message.content.ids is an array with ids in this room\r\n      var clientMapIds = _.keys(this.clientsMap);\r\n      //which ids are new? (in message.content.ids but not in clientsMap)\r\n      var newClientIds = _.difference(message.content.ids, clientMapIds);\r\n      //which ids need to be removed? (in clientsMap but not in message.content.ids)\r\n      var removeClientIds = _.difference(clientMapIds, message.content.ids);\r\n      //update our map\r\n      newClientIds.forEach(function(id){\r\n        this.clientsMap[id] = {\r\n          id: id,\r\n          teamNr: -1,\r\n          motion: 0,\r\n          size: 10\r\n        }\r\n        //add to the smallest team\r\n        var teamNr = (this.clientsByTeam[0].length < this.clientsByTeam[1].length) ? 0 : 1;\r\n        this.clientsMap[id].teamNr = teamNr;\r\n        //send a message to this client\r\n        this.postSocketMessage({\r\n          target: {\r\n            client: id,\r\n            slide: this.name\r\n          },\r\n          content: {\r\n            action: Constants.SET_TEAM,\r\n            team: teamNr\r\n          }\r\n        });\r\n       this.postSocketMessage({\r\n          target: {\r\n            client: 'mobile',\r\n            slide: this.name\r\n          },\r\n          content: {\r\n            action: Constants.SET_SUBSTATE,\r\n            substate: this.substate\r\n          }\r\n        });\r\n        //update the list\r\n        this.updateClientsByTeam();\r\n      }, this);\r\n      removeClientIds.forEach(function(id){\r\n          if(this.clientsMap[id]) {\r\n              //this.clientsMap[id].$div.remove();\r\n          }\r\n          delete this.clientsMap[id];\r\n          this.updateClientsByTeam();\r\n      }, this);\r\n\r\n      this.numClientsChanged();\r\n    } else if(message.content.action === Constants.UPDATE_MOTION) {\r\n      if(!message.sender) {\r\n        return;\r\n      }\r\n      //message.sender.id contains the origin id\r\n      if(!this.clientsMap[message.sender.id]) {\r\n        return;\r\n      }\r\n      this.clientsMap[message.sender.id].motion = Math.min(130, message.content.motion); //limit max motion to 130\r\n    }\r\n  }\r\n\r\n  updateClientsByTeam() {\r\n    this.clientsByTeam = [\r\n      [],\r\n      []\r\n    ];\r\n    let self = this;\r\n    $.each(this.clientsMap, function(id, client){\r\n      if(client.teamNr !== -1) {\r\n        self.clientsByTeam[client.teamNr].push(client);\r\n      }\r\n    });\r\n  }\r\n\r\n  startClickHandler() {\r\n      this.setSubstate(Constants.SHAKE_YOUR_PHONES_GAME);\r\n  }\r\n\r\n  resetMotion() {\r\n    this.motions = [0, 0];\r\n    for(var id in this.clientsMap) {\r\n      this.clientsMap[id].motion = 0;\r\n    }\r\n  }\r\n\r\n  numClientsChanged() {\r\n      this.$slideHolder.find('#connections span').text(_.keys(this.clientsMap).length);\r\n  }\r\n\r\n  showCurrentState() {\r\n    this.$slideHolder.find('.substate').removeClass('active');\r\n    this.$slideHolder.find('.slide').css({\r\n      backgroundImage: 'none'\r\n    });\r\n    if(this.substate === Constants.SHAKE_YOUR_PHONES_GAME) {\r\n      this.music.play();\r\n      this.$slideHolder.find('.substate-game .countdown').html(this.gameDuration);\r\n      this.$slideHolder.find('.substate-game').addClass('active');\r\n      this.countDownTimeout = setTimeout(this.countDownHandler.bind(this, this.gameDuration - 1), 1000);\r\n    } else if(this.substate === Constants.SHAKE_YOUR_PHONES_FINISHED) {\r\n      //show winner\r\n      var ratio = this.calculateRatio();\r\n      var winningTeam = (ratio > 0.5) ? 0 : 1;\r\n      var winningTeamColor = (winningTeam === 0) ? \"red\" : \"blue\";\r\n      this.$slideHolder.find('.substate-finished h1').text('Team ' + winningTeamColor + ' wins!');\r\n      this.$slideHolder.find('.substate-finished').addClass('active');\r\n      //notify the mobile clients\r\n      var winningIds = [];\r\n      var losingIds = [];\r\n      $.each(this.clientsMap, function(id, client){\r\n        if(client.teamNr === winningTeam) {\r\n          winningIds.push(id);\r\n        }\r\n        else {\r\n          losingIds.push(id);\r\n        }\r\n      });\r\n      this.postSocketMessage({\r\n        target: {\r\n          client: winningIds,\r\n          slide: this.name\r\n        },\r\n        content: {\r\n          action: Constants.YOU_WIN\r\n        }\r\n      });\r\n      this.postSocketMessage({\r\n        target: {\r\n          client: losingIds,\r\n          slide: this.name\r\n        },\r\n        content: {\r\n          action: Constants.YOU_LOSE\r\n        }\r\n      });\r\n    } else {\r\n      this.$slideHolder.find('.slide').css({\r\n        backgroundRepeat: 'no-repeat',\r\n        backgroundSize: 'contain',\r\n        backgroundPosition: 'center center',\r\n        backgroundImage: 'url(assets/images/iphone-connections.png)'\r\n      });\r\n      this.$slideHolder.find('.substate-intro').addClass('active');\r\n    }\r\n  }\r\n\r\n  countDownHandler(timeLeft) {\r\n    this.$slideHolder.find('.substate-game .countdown').html(timeLeft);\r\n    if(timeLeft > 0) {\r\n      this.countDownTimeout = setTimeout(this.countDownHandler.bind(this, timeLeft - 1), 1000);\r\n    } else {\r\n      this.setSubstate(Constants.SHAKE_YOUR_PHONES_FINISHED);\r\n    }\r\n  }\r\n\r\n  drawLoop() {\r\n    if(this.substate === Constants.SHAKE_YOUR_PHONES_GAME) {\r\n      //calculate current motions\r\n      var currentMotions = [0, 0];\r\n      $.each(this.clientsMap, function(id, client){\r\n        if(client.teamNr > -1 && client.motion) {\r\n          currentMotions[client.teamNr] += client.motion;\r\n        }\r\n      });\r\n      //take average motion\r\n      currentMotions[0] = (this.clientsByTeam[0].length === 0) ? 0 : currentMotions[0] / this.clientsByTeam[0].length;\r\n      currentMotions[1] = (this.clientsByTeam[1].length === 0) ? 0 : currentMotions[1] / this.clientsByTeam[1].length;\r\n      //add to motion\r\n      this.motions[0] += currentMotions[0];\r\n      this.motions[1] += currentMotions[1];\r\n      //ease it\r\n      this.motions[0] *= 0.97;\r\n      this.motions[1] *= 0.97;\r\n      //visualize it\r\n      this.displayMotions();\r\n    }\r\n  }\r\n\r\n  calculateRatio() {\r\n    var totalMotion = this.motions[0] + this.motions[1];\r\n    var ratio = (totalMotion > 0) ? this.motions[0] / totalMotion : 0.5;\r\n    return ratio;\r\n  }\r\n\r\n  displayMotions() {\r\n    var ratio = this.calculateRatio();\r\n    //console.log(this.motions[0], this.motions[1], totalMotion, ratio);\r\n    $(this.$teamBlocks[0]).css({\r\n      left: 0,\r\n      width: (ratio * 100) + '%'\r\n    });\r\n    $(this.$teamBlocks[1]).css({\r\n      right: 0,\r\n      width: (100 - (ratio * 100)) + '%'\r\n    });\r\n  }\r\n\r\n}\r\n","import {Constants} from '../../../../shared/js/Constants';\r\nimport ContentBase from '../../../../shared/js/classes/ContentBase';\r\n\r\nconst getParameterByName = (url, name) => {\r\n  name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\r\n  let regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\"),\r\n  results = regex.exec(url);\r\n  return results == null ? \"\" : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\r\n};\r\n\r\nexport default class VideoSlide extends ContentBase {\r\n\r\n  constructor($slideHolder) {\r\n    super($slideHolder);\r\n\r\n    this.videoPlaying = false;\r\n    let videoUrl = getParameterByName(this.src, 'video');\r\n\r\n    //check for extra config in the filename\r\n    let loop = false;\r\n    let muted = false;\r\n    let videoUrlSplitted = videoUrl.split('.');\r\n    videoUrlSplitted.forEach(part => {\r\n      if(part === 'loop') {\r\n        loop = true;\r\n      }\r\n      if(part === 'muted') {\r\n        muted = true;\r\n      }\r\n    });\r\n\r\n    this.video = this.$slideHolder.find('video')[0];\r\n    if(loop) {\r\n      $(this.video).attr('loop', \"loop\");\r\n    }\r\n    if(muted) {\r\n      $(this.video).attr('muted', \"muted\");\r\n    }\r\n    $(this.video).attr('src', videoUrl);\r\n    this._clickHandler = this.clickHandler.bind(this);\r\n    $(this.video).on('click', this._clickHandler);\r\n  }\r\n\r\n  destroy() {\r\n    super.destroy();\r\n    $(this.video).off('click', this._clickHandler);\r\n  }\r\n\r\n  onStateChanged() {\r\n    if(this.state === Constants.STATE_ACTIVE) {\r\n      this.setVideoPlaying(true);\r\n    } else {\r\n      this.setVideoPlaying(false);\r\n    }\r\n  }\r\n\r\n  clickHandler(event) {\r\n    this.toggleVideoPlaying();\r\n  }\r\n\r\n  setVideoPlaying(value) {\r\n    if(value !== this.videoPlaying) {\r\n      this.videoPlaying = value;\r\n      if(this.videoPlaying) {\r\n        this.video.play();\r\n      } else {\r\n        this.video.pause();\r\n      }\r\n    }\r\n  }\r\n\r\n  toggleVideoPlaying() {\r\n    this.setVideoPlaying(!this.videoPlaying);\r\n  }\r\n\r\n}\r\n"]}