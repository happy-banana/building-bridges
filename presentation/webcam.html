<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Webcam</title>
	<link rel="stylesheet" href="css/style.css">
	<script>
    window.requireNode = window.require;
    window.require = undefined;
  </script>
</head>
<body>
	<video id="cameraVideo" autoplay></video>
	<script src="js/vendors.min.js"></script>
	<script src="js/script.min.js"></script>
	<script>
	(function(){
		function init() {
			var videoSources = [];
			MediaStreamTrack.getSources(function(mediaSources) {
        mediaSources.forEach(function(mediaSource){
          if (mediaSource.kind === 'video') {
            videoSources.push(mediaSource);
          }
        });
        if(videoSources.length > 0) {
        	var sourceId = videoSources[0].id;
        	//do we have a non-facetime webcam? Use that one
        	videoSources.forEach(function(mediaSource){
        		if(mediaSource.label.toLowerCase().indexOf('facetime') === -1) {
        			sourceId = mediaSource.id;
        		}
        	});

        	var config = {
        		video: {
        			mandatory: {
        				minWidth: 1280,
        				minHeight: 720
        			},
        			optional: [{ sourceId: sourceId }]
        		}
        	};

        	navigator.webkitGetUserMedia(config, function(localMediaStream){
						$('#cameraVideo').attr('src', window.URL.createObjectURL(localMediaStream));
					}, function(error){
						console.log(error);
					});
        }
      });
		}

		init();
	})();
	</script>
</body>
</html>